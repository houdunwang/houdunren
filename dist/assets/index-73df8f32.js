import{a as E,l as L,i as N,k as j,u as q,v as A}from"./element-plus-269c9c95.js";import{_ as V}from"./card-5e9a267c.js";import{_ as J}from"./error-c67a23aa.js";import{_ as K}from"./captcha.vue_vue_type_script_setup_true_lang-e22175fd.js";import{a as F,e as P,c as Q}from"./index-28f279b5.js";import{u as M}from"./useSign-190235fe.js";import{C as R}from"./@icon-park-3742eccb.js";import{F as T,X,o as i,c as g,u as o,J as p,K as n,Q as t,a,b as s,S as U,a8 as Y,M as G,bF as O,af as W,R as d,P as S}from"./@vue-fc98776d.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as B}from"./userAvatar.vue_vue_type_script_setup_true_lang-5d1165fd.js";import{d as H}from"./dayjs-2fa04b10.js";import"./lodash-es-d29772ce.js";import"./async-validator-dee29e8b.js";import"./@vueuse-338b0492.js";import"./@element-plus-828baf85.js";import"./@sxzz-c75af06c.js";import"./escape-html-9595eff5.js";import"./@kangc-b0092abd.js";import"./vue-d4d0ec31.js";import"./normalize-wheel-es-ed76fb12.js";import"./@ctrl-f8748455.js";import"./formInput-3669a072.js";import"./pinia-883c818f.js";import"./vue-demi-71ba0ef2.js";/* empty css                    */import"./vue-router-4dc5009b.js";import"./axios-4a70c6fc.js";import"./prismjs-f5ad2561.js";import"./highlight.js-d90016de.js";import"./vee-validate-30786abe.js";import"./@vee-validate-f9e0ad5b.js";import"./yup-752d7be0.js";import"./property-expr-38205fa5.js";import"./toposort-39c4f588.js";const tt={class:"2xl:w-6/12"},et={class:"flex"},ot={class:"text-sm text-gray-500 ml-3 flex items-center"},nt={key:1,class:"bg-white shadow-sm rounded-lg mb-5 p-5"},st=T({__name:"sign-submit",setup(D){const{open:b}=Q(),{isLogin:k}=F(),{clearError:h}=P(),{add:y}=M(),l=X({content:"",mood:"",captcha_key:"",captcha:"",key:1}),f=["ch","fd","kx","ng","nu","shuai","wl","yl","ym"],v=async()=>{if(l.content.length<5)return E.error("签到内容不能少于5个字");if(!l.captcha)return E.error("请输入验证码");if(!l.mood)return E.error("请选择心情");y(l).then(()=>location.reload()),l.key++};return(I,c)=>{const C=L,x=J,w=N,m=j,u=R,$=V;return i(),g("main",null,[o(k)()?(i(),p($,{key:0},{header:n(()=>[t(" 签到快乐，再接再厉 ")]),footer:n(()=>[a("div",et,[s(m,{type:"success",size:"default",onClick:v},{default:n(()=>[t("开始签到")]),_:1}),a("span",ot,[s(u,{theme:"outline",size:"24",fill:"#7ed321",class:"mr-1"}),t(" 无意义的灌水内容会被删除的 ")])])]),default:n(()=>[a("div",tt,[s(C,{modelValue:o(l).content,"onUpdate:modelValue":c[0]||(c[0]=r=>o(l).content=r),type:"success",size:"default",class:"focus:ring-emerald-600",onFocus:c[1]||(c[1]=r=>o(h)("content")),placeholder:"你今天的心情或最想说的话"},null,8,["modelValue"]),s(x,{name:"content"}),(i(),p(K,{captcha:o(l).captcha,"onUpdate:captcha":c[2]||(c[2]=r=>o(l).captcha=r),captcha_key:o(l).captcha_key,"onUpdate:captcha_key":c[3]||(c[3]=r=>o(l).captcha_key=r),class:"mt-3 captcha",key:o(l).key},null,8,["captcha","captcha_key"])),a("div",{class:"flex flex-wrap gap-3 mt-2",onClick:c[4]||(c[4]=r=>o(h)("mood"))},[(i(),g(U,null,Y(f,(r,z)=>s(w,{class:G(["border-4 rounded-xl w-10 h-10 box-content p-1 cursor-pointer hover:border-red-500 duration-300",{"border-red-500":r==o(l).mood}]),onClick:e=>o(l).mood=r,src:`/assets/sign/${r}.gif`,fit:"cover",lazy:!0,key:z},null,8,["class","onClick","src"])),64))]),s(x,{name:"mood"})])]),_:1})):(i(),g("section",nt,[s(m,{type:"primary",size:"default",onClick:c[5]||(c[5]=r=>o(b)("/login"))},{default:n(()=>[t("登录后签到")]),_:1})]))])}}});const at=Z(st,[["__scopeId","data-v-d968f745"]]),lt={class:"sign"},rt={class:"leading-8"},ct=a("br",null,null,-1),it=a("br",null,null,-1),_t=a("span",{class:"text-orange-500 font-bold"},"houdunren2022",-1),dt=a("br",null,null,-1),mt=a("br",null,null,-1),ut={class:"text-base"},pt={class:"flex justify-start gap-2 items-center"},ft={class:"flex items-center"},gt={class:"flex"},ht={class:"flex flex-col justify-between"},yt={class:"text-xs text-gray-600 flex items-center gap-1 align-top"},xt=a("span",{class:"align-top inline-block"},".",-1),ee=T({__name:"index",async setup(D){let b,k;const{authorize:h}=F(),{collection:y,getTodaySignList:l,todaySign:f,remove:v}=M();return[b,k]=O(()=>l()),await b,k(),(I,c)=>{var z;const C=V,x=N,w=V,m=W("router-link"),u=q,$=j,r=A;return i(),g("main",lt,[o(f)?(i(),p(C,{key:0},{header:n(()=>[t(" 签到快乐，再接再厉 ")]),default:n(()=>{var e,_;return[a("div",rt,[t(" 您上次签到时间: "+d(o(H)(o(f).created_at).format("YYYY-MM-DD HH:mm"))+" ",1),ct,t(" 您的总签到天数: "+d((e=o(f).sign_count)==null?void 0:e.total)+" 天 ",1),it,t(" 您本月签到天数: "+d((_=o(f).sign_count)==null?void 0:_.month)+" 天 ",1)])]}),_:1})):(i(),p(at,{key:1})),s(w,{class:"my-5"},{header:n(()=>[t("微信快签")]),default:n(()=>[a("section",null,[t(" 使用微信签到更快，微信搜索 "),_t,t(" 关注【后盾云】公众号，  发送以『签到』开始的的内容。 "),dt,s(x,{src:"/assets/wechat/input.jpg",fit:"fill",lazy:!0,class:"w-full md:max-w-[400px]"}),mt,t(" 2022年10月18日前注册的老朋友，请先在电脑端绑定微信后再使用微信快签功能，否则使用微信公众号进行微信快签会创建一个新用户。 ")])]),_:1}),s(w,{class:"my-5"},{header:n(()=>[t("早起少年")]),default:n(()=>[a("section",null,[t(" 早上5:00~7.30签到， 并设置了 "),s(m,{to:"/member",class:"text-teal-700"},{default:n(()=>[t("收货地址")]),_:1}),t(" 和 "),s(m,{to:"/member/bind",class:"text-teal-700"},{default:n(()=>[t("手机号")]),_:1}),t("，即可参加 "),s(m,{to:{name:"morning"},class:"text-teal-700"},{default:n(()=>[t("【早起少年】")]),_:1}),t(" 活动， 并有机会得到礼品。 ")])]),_:1}),(z=o(y))!=null&&z.length?(i(),p(C,{key:2},{header:n(()=>[t(" 今日签到排行 ")]),default:n(()=>[a("div",ut,[s(r,{data:o(y),border:"",stripe:"",size:"large","header-cell-class-name":"text-sm","cell-class-name":"text-sm py-4 text-center text-gray-600 ",class:"hidden md:flex"},{default:n(()=>[s(u,{label:"签到的朋友",width:200,align:"left"},{default:n(({row:e})=>[a("div",pt,[s(B,{user:e.user},null,8,["user"]),s(m,{to:{name:"sign.space",query:{uid:e.user.id}}},{default:n(()=>[t(d(e.user.nickname),1)]),_:2},1032,["to"])])]),_:1}),s(u,{label:"签到时间",width:100,align:"center"},{default:n(({row:e})=>[t(d(o(H)(e.created_at).format("HH:mm")),1)]),_:1}),s(u,{label:"月签到天数",width:120,align:"center"},{default:n(({row:e})=>{var _;return[t(d((_=e.sign_count)==null?void 0:_.month),1)]}),_:1}),s(u,{label:"总签到天数",width:120,align:"center"},{default:n(({row:e})=>{var _;return[t(d((_=e.sign_count)==null?void 0:_.total),1)]}),_:1}),s(u,{label:"签到心情"},{default:n(({row:e})=>[a("div",ft,[s(x,{class:"w-12 h-12 box-content p-1",src:`/assets/sign/${e.mood}.gif`,fit:"cover",lazy:!0},null,8,["src"]),t(" "+d(e.content)+" ",1),o(h)(e.user.id)?(i(),p($,{key:0,type:"warning",size:"small",plain:"",onClick:_=>o(v)(+e.id),class:"ml-2"},{default:n(()=>[t(" 删除 ")]),_:2},1032,["onClick"])):S("",!0)])]),_:1})]),_:1},8,["data"]),(i(!0),g(U,null,Y(o(y),e=>{var _;return i(),g("div",{class:"md:hidden border-b py-3",key:e.id},[a("div",gt,[s(B,{user:e.user,class:"mr-2"},null,8,["user"]),a("div",ht,[t(d(e.content)+" ",1),o(h)(e.user.id)?(i(),p($,{key:0,type:"warning",size:"small",plain:"",onClick:bt=>o(v)(+e.id)},{default:n(()=>[t(" 删除 ")]),_:2},1032,["onClick"])):S("",!0),a("div",yt,[s(m,{to:{name:"sign.space",query:{uid:e.user_id}},class:"text-indigo-800 font-bold opacity-70"},{default:n(()=>[t(d(e.user.nickname),1)]),_:2},1032,["to"]),a("span",null,d(o(H)(e.created_at).fromNow()),1),xt,a("span",null,"总签到 "+d((_=e.sign_count)==null?void 0:_.total)+" 天",1)])])])])}),128))])]),_:1})):S("",!0)])}}});export{ee as default};
